<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>elm-kitchen</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="canonical" href="XXX" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      crossorigin="anonymous"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
      crossorigin=""
      integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css"
      crossorigin=""
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet.locatecontrol@0.70.0/dist/L.Control.Locate.min.css"
      crossorigin=""
    />
    <script
      src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
      crossorigin=""
      integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
    ></script>
    <script
      src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"
      crossorigin=""
    ></script>
    <script
      src="https://unpkg.com/leaflet.locatecontrol@0.70.0/dist/L.Control.Locate.min.js"
      crossorigin=""
    ></script>
    <link rel="stylesheet" href="/static/icons/styles.css" />
    <link rel="stylesheet" href="/static/css/style.css" />
  </head>
  <body>
    <script src="elm.js"></script>
    <script src="/static/js/app.js"></script>
    <script>
      // The localStorage key to use to store serialized session data
      const storeKey = "a4a";

      const app = Elm.Main.init({
        flags: {
          clientUrl: location.origin + location.pathname,
          rawStore: localStorage[storeKey] || ""
        }
      });

      app.ports.saveStore.subscribe(rawStore => {
        localStorage[storeKey] = rawStore;
      });

      // Ensure session is refreshed when it changes in another tab/window
      window.addEventListener(
        "storage",
        event => {
          if (event.storageArea === localStorage && event.key === storeKey) {
            app.ports.storeChanged.send(event.newValue);
          }
        },
        false
      );
    </script>
  </body>
</html>
